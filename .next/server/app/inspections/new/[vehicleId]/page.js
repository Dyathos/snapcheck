(()=>{var e={};e.id=526,e.ids=[526],e.modules={3524:e=>{"use strict";e.exports=require("@prisma/client")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1668:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>a.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>o,routeModule:()=>x,tree:()=>d});var r=t(7096),i=t(6132),n=t(7284),a=t.n(n),l=t(2564),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);t.d(s,c);let d=["",{children:["inspections",{children:["new",{children:["[vehicleId]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,4849)),"/Users/capmission/Documents/carcheck/src/app/inspections/new/[vehicleId]/page.tsx"]}]},{}]},{}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,5607)),"/Users/capmission/Documents/carcheck/src/app/layout.tsx"],error:[()=>Promise.resolve().then(t.bind(t,6097)),"/Users/capmission/Documents/carcheck/src/app/error.tsx"],loading:[()=>Promise.resolve().then(t.bind(t,8056)),"/Users/capmission/Documents/carcheck/src/app/loading.tsx"],"not-found":[()=>Promise.resolve().then(t.bind(t,5666)),"/Users/capmission/Documents/carcheck/src/app/not-found.tsx"]}],o=["/Users/capmission/Documents/carcheck/src/app/inspections/new/[vehicleId]/page.tsx"],u="/inspections/new/[vehicleId]/page",m={require:t,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/inspections/new/[vehicleId]/page",pathname:"/inspections/new/[vehicleId]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},7731:(e,s,t)=>{Promise.resolve().then(t.bind(t,984)),Promise.resolve().then(t.bind(t,1372))},984:(e,s,t)=>{"use strict";t.r(s),t.d(s,{InspectionWizard:()=>d});var r=t(3854),i=t(4218),n=t(1018),a=t(8711),l=t(8746);let c={good:"Bon \xe9tat",warning:"\xc0 surveiller",critical:"Critique"};function d({vehicle:e}){let s=(0,n.useRouter)(),[t,d]=(0,i.useState)(1),[o,u]=(0,i.useState)(new Set),[m,x]=(0,i.useState)({}),[p,h]=(0,i.useState)(null),[v,g]=(0,i.useState)(!1);return(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("div",{className:"border-b pb-4",children:r.jsx("nav",{className:"flex justify-between",children:[1,2,3,4].map(e=>(0,r.jsxs)("div",{className:`flex items-center ${e===t?"text-blue-600":e<t?"text-gray-500":"text-gray-300"}`,children:[r.jsx("span",{className:`w-8 h-8 flex items-center justify-center rounded-full ${e===t?"bg-blue-600 text-white":e<t?"bg-gray-500 text-white":"bg-gray-200"}`,children:e}),(0,r.jsxs)("span",{className:"ml-2 text-sm font-medium",children:[1===e&&"S\xe9lection",2===e&&"Inspection",3===e&&"R\xe9sum\xe9",4===e&&"Validation"]})]},e))})}),1===t&&r.jsx(()=>(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("h3",{className:"text-lg font-medium",children:"S\xe9lectionnez les pi\xe8ces \xe0 inspecter"}),r.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:e.parts.map(e=>r.jsx("button",{onClick:()=>{let s=new Set(o);o.has(e.id)?s.delete(e.id):s.add(e.id),u(s)},className:`p-4 border rounded-lg text-left transition-colors ${o.has(e.id)?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"}`,children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[r.jsx("h4",{className:"font-medium",children:e.name}),e.description&&r.jsx("p",{className:"text-sm text-gray-500",children:e.description})]}),r.jsx(l.C,{variant:"critical"===e.severity?"destructive":"high"===e.severity?"warning":"default",children:e.status})]})},e.id))}),r.jsx("div",{className:"flex justify-end mt-6",children:r.jsx(a.z,{onClick:()=>d(2),disabled:0===o.size,children:"Continuer"})})]}),{}),2===t&&r.jsx(()=>(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("h3",{className:"text-lg font-medium",children:"Inspectez les pi\xe8ces s\xe9lectionn\xe9es"}),Array.from(o).map(s=>{let t=e.parts.find(e=>e.id===s);return t?(0,r.jsxs)("div",{className:"border rounded-lg p-4 space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("h4",{className:"font-medium",children:t.name}),(0,r.jsxs)(l.C,{variant:"critical"===t.severity?"destructive":"high"===t.severity?"warning":"default",children:["\xc9tat actuel : ",t.status]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nouvel \xe9tat"}),(0,r.jsxs)("select",{value:m[t.id]?.status||"good",onChange:e=>{x({...m,[t.id]:{...m[t.id],id:t.id,status:e.target.value}})},className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",children:[r.jsx("option",{value:"good",children:"Bon \xe9tat"}),r.jsx("option",{value:"warning",children:"\xc0 surveiller"}),r.jsx("option",{value:"critical",children:"Critique"})]})]}),(0,r.jsxs)("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Notes"}),r.jsx("textarea",{value:m[t.id]?.notes||"",onChange:e=>{x({...m,[t.id]:{...m[t.id],id:t.id,notes:e.target.value}})},rows:2,className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm"})]})]},t.id):null}),(0,r.jsxs)("div",{className:"flex justify-between mt-6",children:[r.jsx(a.z,{variant:"outline",onClick:()=>d(1),children:"Retour"}),r.jsx(a.z,{onClick:()=>d(3),disabled:Object.keys(m).length!==o.size,children:"Continuer"})]})]}),{}),3===t&&r.jsx(()=>(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("h3",{className:"text-lg font-medium",children:"R\xe9sum\xe9 des changements"}),r.jsx("div",{className:"space-y-4",children:Array.from(o).map(s=>{let t=e.parts.find(e=>e.id===s),i=m[s];return t&&i?(0,r.jsxs)("div",{className:"border rounded-lg p-4",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("h4",{className:"font-medium",children:t.name}),(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsxs)(l.C,{variant:"default",children:["Avant : ",t.status]}),r.jsx("span",{className:"text-gray-500",children:"â†’"}),(0,r.jsxs)(l.C,{variant:"critical"===i.status?"destructive":"warning"===i.status?"warning":"success",children:["Apr\xe8s : ",c[i.status]]})]})]}),i.notes&&r.jsx("p",{className:"mt-2 text-sm text-gray-500",children:i.notes})]},t.id):null})}),(0,r.jsxs)("div",{className:"flex justify-between mt-6",children:[r.jsx(a.z,{variant:"outline",onClick:()=>d(2),children:"Modifier"}),r.jsx(a.z,{onClick:()=>d(4),children:"Continuer"})]})]}),{}),4===t&&r.jsx(()=>{let t=e.parts.filter(e=>!o.has(e.id)),i=async()=>{try{g(!0),h(null);let r={vehicleId:e.id,inspector:"Inspector Name",status:"completed",notes:"",parts:[...Array.from(o).map(e=>({id:e,status:m[e].status,notes:m[e].notes})),...t.map(e=>({id:e.id,status:e.status,notes:""}))]},i=await fetch("/api/inspections",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),n=await i.json();if(!i.ok)throw Error(n.error||"Erreur lors de la cr\xe9ation de l'inspection");s.refresh(),s.push("/inspections")}catch(e){console.error("Error creating inspection:",e),h(e instanceof Error?e.message:"Une erreur est survenue lors de la cr\xe9ation de l'inspection")}finally{g(!1)}};return(0,r.jsxs)("div",{className:"space-y-6",children:[r.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4",children:r.jsx("div",{className:"flex",children:(0,r.jsxs)("div",{className:"ml-3",children:[r.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Confirmation des autres pi\xe8ces"}),r.jsx("div",{className:"mt-2 text-sm text-yellow-700",children:(0,r.jsxs)("p",{children:[t.length," pi\xe8ces n'ont pas \xe9t\xe9 modifi\xe9es. Leur \xe9tat pr\xe9c\xe9dent sera conserv\xe9."]})})]})})}),(0,r.jsxs)("div",{className:"space-y-4",children:[r.jsx("h4",{className:"font-medium",children:"Pi\xe8ces non modifi\xe9es :"}),r.jsx("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:t.map(e=>r.jsx("div",{className:"border rounded-lg p-4",children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("h5",{className:"font-medium",children:e.name}),r.jsx(l.C,{variant:"critical"===e.status?"destructive":"warning"===e.status?"warning":"success",children:c[e.status]})]})},e.id))})]}),p&&r.jsx("div",{className:"rounded-md bg-red-50 p-4",children:r.jsx("p",{className:"text-sm text-red-600",children:p})}),(0,r.jsxs)("div",{className:"flex justify-between mt-6",children:[r.jsx(a.z,{variant:"outline",onClick:()=>d(3),children:"Retour"}),(0,r.jsxs)("div",{className:"space-x-4",children:[r.jsx(a.z,{variant:"outline",onClick:()=>d(1),children:"Ajouter une pi\xe8ce"}),r.jsx(a.z,{onClick:i,disabled:v,children:v?"Validation...":"Valider l'inspection"})]})]})]})},{})]})}},8746:(e,s,t)=>{"use strict";t.d(s,{C:()=>c});var r=t(3854),i=t(4218),n=t(2457),a=t(8504);let l=(0,n.j)("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/80",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"bg-green-500 text-white hover:bg-green-400",warning:"bg-yellow-500 text-black hover:bg-yellow-400"}},defaultVariants:{variant:"default"}}),c=(0,i.forwardRef)(({className:e,variant:s,children:t,...i},n)=>r.jsx("div",{className:(0,a.cn)(l({variant:s}),e),ref:n,...i,children:t}));c.displayName="Badge"},8711:(e,s,t)=>{"use strict";t.d(s,{z:()=>c});var r=t(3854),i=t(4218),n=t(2457),a=t(8504);let l=(0,n.j)("inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:opacity-50 disabled:pointer-events-none ring-offset-background",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"underline-offset-4 hover:underline text-primary"},size:{default:"h-10 py-2 px-4",sm:"h-9 px-3 rounded-md",lg:"h-11 px-8 rounded-md",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=(0,i.forwardRef)(({className:e,variant:s,size:t,...i},n)=>r.jsx("button",{className:(0,a.cn)(l({variant:s,size:t}),e),ref:n,...i}));c.displayName="Button"},4849:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>m});var r=t(4656),i=t(1412),n=t(6085),a=t(9730),l=t(5153);let c=(0,l.createProxy)(String.raw`/Users/capmission/Documents/carcheck/src/app/inspections/components/InspectionWizard.tsx`),{__esModule:d,$$typeof:o}=c;c.default;let u=(0,l.createProxy)(String.raw`/Users/capmission/Documents/carcheck/src/app/inspections/components/InspectionWizard.tsx#InspectionWizard`);async function m({params:e}){let s=await a._.vehicle.findUnique({where:{id:e.vehicleId},include:{parts:!0}});return s||(0,i.notFound)(),(0,r.jsxs)(r.Fragment,{children:[r.jsx(n.ZP,{title:`Inspection de ${s.brand} ${s.model}`,showBack:!0}),r.jsx("div",{className:"p-4",children:r.jsx("div",{className:"max-w-3xl mx-auto space-y-6",children:r.jsx("div",{className:"bg-white shadow-sm rounded-lg p-6",children:r.jsx(u,{vehicle:s})})})})]})}},789:(e,s,t)=>{"use strict";t.d(s,{Z:()=>n});var r=t(4218);let i=r.forwardRef(function({title:e,titleId:s,...t},i){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:i,"aria-labelledby":s},t),e?r.createElement("title",{id:s},e):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 19.5 8.25 12l7.5-7.5"}))}),n=i},2457:(e,s,t)=>{"use strict";t.d(s,{j:()=>a});var r=t(9395);let i=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,n=r.W,a=(e,s)=>t=>{var r;if((null==s?void 0:s.variants)==null)return n(e,null==t?void 0:t.class,null==t?void 0:t.className);let{variants:a,defaultVariants:l}=s,c=Object.keys(a).map(e=>{let s=null==t?void 0:t[e],r=null==l?void 0:l[e];if(null===s)return null;let n=i(s)||i(r);return a[e][n]}),d=t&&Object.entries(t).reduce((e,s)=>{let[t,r]=s;return void 0===r||(e[t]=r),e},{}),o=null==s?void 0:null===(r=s.compoundVariants)||void 0===r?void 0:r.reduce((e,s)=>{let{class:t,className:r,...i}=s;return Object.entries(i).every(e=>{let[s,t]=e;return Array.isArray(t)?t.includes({...l,...d}[s]):({...l,...d})[s]===t})?[...e,t,r]:e},[]);return n(e,c,o,null==t?void 0:t.class,null==t?void 0:t.className)}}};var s=require("../../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),r=s.X(0,[271,503,445],()=>t(1668));module.exports=r})();